import{S as be,i as ve,s as de,k as U,l as D,m as A,h as n,b as m,I as x,o as Se,O as Ee,w as $e,y as O,a as d,q as E,z as V,c as S,r as $,A as M,E as C,L as fe,u as ge,g as X,d as z,B as H,P as ke,N as we}from"../chunks/index.a1ad4ba8.js";import{S as ye,U as ue}from"../chunks/UPlotRealtime.7165a2b5.js";import{a as me,c as Ce,u as Ie,d as Te,e as Pe}from"../chunks/sceneGraph.8c923948.js";import{a as qe,U as Ue}from"../chunks/UPlotTorque.baa31d97.js";function De(t){const l=[];for(var r=0;r<t.length;r++){let o;try{t[r]instanceof Array?o=me(t[r][0],t[r][1]):o=me(t[r]);let p=Ce(o);p.state.throttleInput=1,l.push(p)}catch{}}let a=ye();return a.subscribeTick((o,p)=>{for(let f=0;f<l.length;f++){let i=l[f];i=Ie(i,p);let v=i.props.engine.torqueX[i.props.engine.torqueX.length-1];if(i.state.engineRpm>=v){let u=i.props.gearRatio.length-1;i.state.gearInput<u&&(i.state.gearInput+=1)}l[f]=i}}),{carEntities:l,simulation:a}}function Fe(t){let l;return{c(){l=U("div")},l(r){l=D(r,"DIV",{}),A(l).forEach(n)},m(r,a){m(r,l,a),t[4](l)},p:x,i:x,o:x,d(r){r&&n(l),t[4](null)}}}function Ge(t,l,r){let{carEntities:a}=l,{simulation:o}=l,{colors:p}=l,f,i;Se(()=>{i=Te(a,o,p),f.appendChild(i.element);const u=f.clientWidth,k=f.clientHeight;console.log(u,k),i.updateOpts({width:u,height:k})}),Ee(()=>{i&&i.destroy()});function v(u){$e[u?"unshift":"push"](()=>{f=u,r(0,f)})}return t.$$set=u=>{"carEntities"in u&&r(1,a=u.carEntities),"simulation"in u&&r(2,o=u.simulation),"colors"in u&&r(3,p=u.colors)},[f,a,o,p,v]}class Re extends be{constructor(l){super(),ve(this,l,Ge,Fe,de,{carEntities:1,simulation:2,colors:3})}}function pe(t,l,r){const a=t.slice();return a[9]=l[r],a}function ce(t){let l,r=t[9].props.name+"",a,o,p=t[9].props.trim+"",f;return{c(){l=E("Car : "),a=E(r),o=d(),f=E(p)},l(i){l=$(i,"Car : "),a=$(i,r),o=S(i),f=$(i,p)},m(i,v){m(i,l,v),m(i,a,v),m(i,o,v),m(i,f,v)},p:x,d(i){i&&n(l),i&&n(a),i&&n(o),i&&n(f)}}}function he(t){let l,r,a,o,p,f,i,v,u,k,F,b,L,B=(t[0]/1e3).toFixed(1)+"",W,j,I,ee,ne=Math.floor(_e*3.6)+"",te,J,T,ie,ae=Pe(_e,t[2][0].props.weight,t[2][0].props.dragCoef*t[2][0].props.dragArea).toFixed(1)+"",le,K,P,Q,q,Y,w,Z,y,N,se,oe;l=new Re({props:{carEntities:t[2],simulation:t[3],colors:t[1]}});let G=t[2],c=[];for(let e=0;e<G.length;e+=1)c[e]=ce(pe(t,G,e));return P=new qe({props:{car:t[2][0].props}}),q=new Ue({props:{cars:t[2].map(Be)}}),w=new ue({props:{title:"Speed",key:"speed",transformFn:Ae,time:t[0],colors:t[1],observed:t[2]}}),y=new ue({props:{title:"Acceleration",units:"m/sÂ²",key:"acceleration",time:t[0],colors:t[1],observed:t[2]}}),{c(){O(l.$$.fragment),r=d();for(let e=0;e<c.length;e+=1)c[e].c();a=d(),o=U("button"),p=E("Start"),f=d(),i=U("button"),v=E("Stop"),u=d(),k=U("br"),F=d(),b=U("div"),L=E("Time simulation elapsed : "),W=E(B),j=d(),I=U("div"),ee=E("Speed : "),te=E(ne),J=d(),T=U("div"),ie=E("Power needed : "),le=E(ae),K=d(),O(P.$$.fragment),Q=d(),O(q.$$.fragment),Y=d(),O(w.$$.fragment),Z=d(),O(y.$$.fragment)},l(e){V(l.$$.fragment,e),r=S(e);for(let re=0;re<c.length;re+=1)c[re].l(e);a=S(e),o=D(e,"BUTTON",{});var s=A(o);p=$(s,"Start"),s.forEach(n),f=S(e),i=D(e,"BUTTON",{});var g=A(i);v=$(g,"Stop"),g.forEach(n),u=S(e),k=D(e,"BR",{}),F=S(e),b=D(e,"DIV",{});var R=A(b);L=$(R,"Time simulation elapsed : "),W=$(R,B),R.forEach(n),j=S(e),I=D(e,"DIV",{});var _=A(I);ee=$(_,"Speed : "),te=$(_,ne),_.forEach(n),J=S(e),T=D(e,"DIV",{});var h=A(T);ie=$(h,"Power needed : "),le=$(h,ae),h.forEach(n),K=S(e),V(P.$$.fragment,e),Q=S(e),V(q.$$.fragment,e),Y=S(e),V(w.$$.fragment,e),Z=S(e),V(y.$$.fragment,e)},m(e,s){M(l,e,s),m(e,r,s);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(e,s);m(e,a,s),m(e,o,s),C(o,p),m(e,f,s),m(e,i,s),C(i,v),m(e,u,s),m(e,k,s),m(e,F,s),m(e,b,s),C(b,L),C(b,W),m(e,j,s),m(e,I,s),C(I,ee),C(I,te),m(e,J,s),m(e,T,s),C(T,ie),C(T,le),m(e,K,s),M(P,e,s),m(e,Q,s),M(q,e,s),m(e,Y,s),M(w,e,s),m(e,Z,s),M(y,e,s),N=!0,se||(oe=[fe(o,"click",t[4]),fe(i,"click",t[5])],se=!0)},p(e,[s]){if(s&4){G=e[2];let _;for(_=0;_<G.length;_+=1){const h=pe(e,G,_);c[_]?c[_].p(h,s):(c[_]=ce(h),c[_].c(),c[_].m(a.parentNode,a))}for(;_<c.length;_+=1)c[_].d(1);c.length=G.length}(!N||s&1)&&B!==(B=(e[0]/1e3).toFixed(1)+"")&&ge(W,B);const g={};s&1&&(g.time=e[0]),w.$set(g);const R={};s&1&&(R.time=e[0]),y.$set(R)},i(e){N||(X(l.$$.fragment,e),X(P.$$.fragment,e),X(q.$$.fragment,e),X(w.$$.fragment,e),X(y.$$.fragment,e),N=!0)},o(e){z(l.$$.fragment,e),z(P.$$.fragment,e),z(q.$$.fragment,e),z(w.$$.fragment,e),z(y.$$.fragment,e),N=!1},d(e){H(l,e),e&&n(r),ke(c,e),e&&n(a),e&&n(o),e&&n(f),e&&n(i),e&&n(u),e&&n(k),e&&n(F),e&&n(b),e&&n(j),e&&n(I),e&&n(J),e&&n(T),e&&n(K),H(P,e),e&&n(Q),H(q,e),e&&n(Y),H(w,e),e&&n(Z),H(y,e),se=!1,we(oe)}}}let _e=0;function Ae(t){return t*3.6}const Be=t=>t.props;function Ne(t,l,r){let{data:a}=l,{carIds:o=a.carIds}=l;const p=["blue","red","orange","green","purple"];let{carEntities:f,simulation:i,setup3Dsimulation:v}=De(o),u=0;i.subscribeTick((b,L)=>{r(0,u=b)});function k(){i.start()}function F(){i.stop()}return t.$$set=b=>{"data"in b&&r(6,a=b.data),"carIds"in b&&r(7,o=b.carIds)},[u,p,f,i,k,F,a,o]}class ze extends be{constructor(l){super(),ve(this,l,Ne,he,de,{data:6,carIds:7})}}export{ze as default};

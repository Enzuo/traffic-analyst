import{S as G,A as U,B as H,M as L,a as P,P as V,b as z,c as K}from"./loader.04de8719.js";import{c as q}from"./CarEntity3D.7601f0c5.js";import{S as R,i as A,s as v,k as D,l as _,m as T,h as S,b as X,I as w,w as k}from"./index.6ad261be.js";import{u as j}from"./uPlot.min.945a0543.js";import{d as y,e as M,f as O,h as F,t as W}from"./index.e789bfc7.js";class ie extends G{constructor(n){super(),B(this.scene),this.animation=new K(this.scene,this.camera,this.renderer,this.cameraControls),this.animation.start(),q(n).then(e=>this.animation.setCar(e.object))}updateData(n){this.animation.removeCar().then(e=>{e&&this.scene.remove(e)}),q(n).then(e=>this.animation.setCar(e.object))}}class oe extends G{constructor(n,e,s){super(),this.animation=new U(this.scene,this.camera,this.renderer,this.cameraControls,e),this.animation.start();const i=Y(this.scene);this.animation.addAnimated(i),B(this.scene),n.forEach((u,h)=>{const d=h*3-(n.length-1)*3/2;q(u,s[h]).then(m=>{this.scene.add(m.object),m.object.position.x=d,this.animation.addAnimatedObject(m)})})}}function Y(t){const n=new H,e=new L({color:65280}),s=new P(n,e);s.position.y=2,s.castShadow=!0,t.add(s),s.position.z=-3,s.position.x=-3;function i(u){s.rotation.x+=.01,s.rotation.y+=.01}return{animate:i,object:s}}function B(t,n=10){const e=new V(10,n),s=new z({color:16777215}),i=new P(e,s);i.rotation.x=-Math.PI/2,i.receiveShadow=!0,t.add(i)}function J(t,n){let e=[[]],s=[];const i=["blue","red","orange","green","purple","grey","grey","grey","grey","grey","grey","grey"];for(let r=0;r<t.gearRatio.length;r++)s.push({label:r+1,scale:"n",value:(a,o)=>o==null?"-":o.toFixed(0),stroke:i[r]}),e.push([]);let u={label:"drag",scale:"n",value:(r,a)=>a==null?"-":a.toFixed(1),stroke:"darkgrey"};e.push([]);const h=2,p=200;let d=0;for(;d<=p;){e[0].push(d);let r=d/3.6;if(t.type==="plane"){let a;if(t.engine.thrust)a=t.engine.thrust;else{let o=y(t.engine.torqueCurve,2700);a=F(o,5.325,1,200)}e[1].push(a),e[e.length-1].push(M(r,t.weight,t.dragArea*t.dragCoef)),d+=h;continue}for(let a=0;a<t.gearRatio.length;a++){let o=t.gearRatio[a]*t.driveRatio*(t.gearTransfer?t.gearTransfer[0]:1),c=O(r,o,t.wheelDiameter),x=y(t.engine.torqueCurve,c),g=F(x,o,null,t.wheelDiameter);e[a+1].push(g)}e[e.length-1].push(M(r,t.weight,t.dragArea*t.dragCoef)),d+=h}const m={title:"Gearing",width:800,height:300,cursor:{drag:{setScale:!1}},series:[{},...s,u],scales:{x:{title:"speed",time:!1},y:{}},axes:[{},{space:60,scale:"n",values:(r,a,o)=>a.map(c=>+c.toFixed(0)),side:1,grid:{show:!1}}]};let l=new j(m,e,n);return{setData:r=>{l.setData(r)}}}function N(t){let n;return{c(){n=D("div")},l(e){n=_(e,"DIV",{}),T(n).forEach(S)},m(e,s){X(e,n,s),t[2](n)},p:w,i:w,o:w,d(e){e&&S(n),t[2](null)}}}function Q(t,n,e){let{car:s}=n,i;function u(h){k[h?"unshift":"push"](()=>{i=h,e(0,i),e(1,s)})}return t.$$set=h=>{"car"in h&&e(1,s=h.car)},t.$$.update=()=>{t.$$.dirty&3&&i&&(e(0,i.innerHTML="",i),J(s,i))},[i,s,u]}class le extends R{constructor(n){super(),A(this,n,Q,N,v,{car:1})}}function Z(t,n,e={}){let s=e.colors?e.colors:["blue","red","orange","green"],i=[];for(let l=0;l<t.length;l++){t[l];let r={label:"torque",scale:"nm",value:(o,c)=>c==null?"-":c.toFixed(0),stroke:s[l],dash:[10,5],spanGaps:!0,points:{show:!1}},a={label:"power",scale:"hp",value:(o,c)=>c==null?"-":c.toFixed(0),stroke:s[l],spanGaps:!0,points:{show:!1}};i.push(r),i.push(a)}function u(l,r=100){let a=0,o=l.map(f=>{let b=f.engine.torqueXMultiplier||1;return f.engine.torqueX[f.engine.torqueX.length-1]*b}),c=Math.max(...o),x=[];for(var g=a;g<=c;g+=r)x.push(g);return x}function h(l,r){let a=l.engine;a.torqueXMultiplier;let o=y(a.torqueCurve,r),c=W(o,r);return{torque:o,power:c}}function p(l){let r=u(l),a=[r];for(var o=0;o<l.length;o++){let c=l[o];c.engine.torqueXMultiplier;let g=[],f=[];for(let b=0;b<r.length;b++){let C=r[b],{torque:E,power:I}=h(c,C);g.push(E),f.push(I)}a.push(g),a.push(f)}return a}let d=p(t);const m={title:"Power",width:800,height:300,cursor:{drag:{setScale:!1}},series:[{},...i],scales:{x:{title:"rpm",time:!1},hp:{}},axes:[{},{space:60,scale:"nm",values:(l,r,a)=>r.map(o=>+o.toFixed(0)),side:1,grid:{show:!1}},{space:60,scale:"hp",values:(l,r,a)=>r.map(o=>+o.toFixed(0)),side:1,grid:{show:!1}}]};new j(m,d,n)}function $(t){let n;return{c(){n=D("div")},l(e){n=_(e,"DIV",{}),T(n).forEach(S)},m(e,s){X(e,n,s),t[3](n)},p:w,i:w,o:w,d(e){e&&S(n),t[3](null)}}}function ee(t,n,e){let{cars:s}=n,{opts:i={}}=n,u;function h(p){k[p?"unshift":"push"](()=>{u=p,e(0,u),e(1,s),e(2,i)})}return t.$$set=p=>{"cars"in p&&e(1,s=p.cars),"opts"in p&&e(2,i=p.opts)},t.$$.update=()=>{t.$$.dirty&7&&u&&(e(0,u.innerHTML="",u),Z(s,u,i))},[u,s,i,h]}class ue extends R{constructor(n){super(),A(this,n,ee,$,v,{cars:1,opts:2})}}export{ie as S,ue as U,le as a,oe as b};

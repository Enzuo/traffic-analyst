import{d as L,A as oe,B as le,M as ue,e as N,P as ce,f as he,g as fe}from"./loader.6aynuUIT.js";import{c as P}from"./CarEntity3D.KPdg1nMm.js";import{s as E,V as I,W as T,b as C,f as d,X as B,p as y,i as b,h as D,n as X,e as M,a as W,B as F,c as S,g as K,t as Y,d as J,l as O}from"./scheduler.C19aQTI2.js";import{S as A,i as j,a as x,g as Q,t as q,e as Z,c as $,b as ee,m as te,d as se}from"./index.B0knyX5n.js";import{u as re}from"./uPlot.min.D9LKXES3.js";import{b as R,c as z,d as me,e as V,t as ge}from"./index.BPu2XYXM.js";class Pe extends L{constructor(s){super(),ne(this.scene),this.animation=new fe(this.scene,this.camera,this.renderer,this.cameraControls),this.animation.start(),P(s).then(n=>this.animation.setCar(n.object))}updateData(s){this.animation.removeCar().then(n=>{n&&this.scene.remove(n)}),P(s).then(n=>this.animation.setCar(n.object))}}class Re extends L{constructor(s,n,t){super(),this.animation=new oe(this.scene,this.camera,this.renderer,this.cameraControls,n),this.animation.start();const i=pe(this.scene);this.animation.addAnimated(i),ne(this.scene),s.forEach((e,r)=>{const u=r*3-(s.length-1)*3/2;P(e,t[r]).then(_=>{this.scene.add(_.object),_.object.position.x=u,this.animation.addAnimatedObject(_)})})}}function pe(a){const s=new le,n=new ue({color:65280}),t=new N(s,n);t.position.y=2,t.castShadow=!0,a.add(t),t.position.z=-3,t.position.x=-3;function i(e){t.rotation.x+=.01,t.rotation.y+=.01}return{animate:i,object:t}}function ne(a,s=10){const n=new ce(10,s),t=new he({color:16777215}),i=new N(n,t);i.rotation.x=-Math.PI/2,i.receiveShadow=!0,a.add(i)}function de(a){let s,n,t,i,e;return{c(){s=I("svg"),n=I("use"),this.h()},l(r){s=T(r,"svg",{class:!0,style:!0});var o=C(s);n=T(o,"use",{"xlink:href":!0}),C(n).forEach(d),o.forEach(d),this.h()},h(){B(n,"xlink:href",t="symbol-defs.svg#icon-"+a[0]),y(s,"class",i="icon icon-"+a[0]+" svelte-8w0jsv"),y(s,"style",e=`width: ${1*a[1]}em; height: ${1*a[1]}em;`)},m(r,o){b(r,s,o),D(s,n)},p(r,[o]){o&1&&t!==(t="symbol-defs.svg#icon-"+r[0])&&B(n,"xlink:href",t),o&1&&i!==(i="icon icon-"+r[0]+" svelte-8w0jsv")&&y(s,"class",i),o&2&&e!==(e=`width: ${1*r[1]}em; height: ${1*r[1]}em;`)&&y(s,"style",e)},i:X,o:X,d(r){r&&d(s)}}}function we(a,s,n){let{name:t}=s,{size:i=1}=s;return a.$$set=e=>{"name"in e&&n(0,t=e.name),"size"in e&&n(1,i=e.size)},[t,i]}class ae extends A{constructor(s){super(),j(this,s,we,de,E,{name:0,size:1})}}function _e(a,s,n={}){let t=[[]],i=[];const e=["blue","red","orange","green","purple","grey","grey","grey","grey","grey","grey","grey"];for(let l=0;l<a.gearbox.gearRatio.length;l++)i.push({label:l+1,scale:"n",value:(p,c)=>c==null?"-":c.toFixed(0),stroke:e[l]}),t.push([]);let r={label:"drag",scale:"n",value:(l,p)=>p==null?"-":p.toFixed(1),stroke:"darkgrey"};t.push([]);const o=2,u=200;let _=0;const h=a.engine.torqueCurve.length?a.engine.torqueCurve[0][0]:0,f=a.engine.torqueCurve.length?a.engine.torqueCurve[a.engine.torqueCurve.length-1][0]:0;for(;_<=u;){t[0].push(_);let l=_/3.6;if(a.type==="plane"){let c;if(a.engine.thrust)c=a.engine.thrust;else{let w=R(a.engine.torqueCurve,2700);c=V(w,5.325,1,200)}t[1].push(c),t[t.length-1].push(z(l,a.weight,a.dragArea*a.dragCoef)),_+=o;continue}let p=a.gearbox;for(let c=0;c<p.gearRatio.length;c++){let w=p.gearRatio[c]*p.driveRatio*(p.gearTransfer?p.gearTransfer[0]:1),v=me(l,w,a.wheelDiameter),k=R(a.engine.torqueCurve,v,a.engine.power),G=V(k,w,null,a.wheelDiameter);n.isGearForce?t[c+1].push(G):v>h&&v<f?t[c+1].push(v):t[c+1].push(null)}n.isGearForce&&t[t.length-1].push(z(l,a.weight,a.dragArea*a.dragCoef)),_+=o}const g={title:"Gearing",width:800,height:300,cursor:{drag:{setScale:!1}},series:[{label:"km/h"},...i,r],scales:{x:{title:"speed",time:!1},y:{}},axes:[{},{space:60,scale:"n",values:(l,p,c)=>p.map(w=>+w.toFixed(0)),side:1,grid:{show:!1}}]};let m=new re(g,t,s);return{setData:l=>{m.setData(l)}}}function U(a){let s,n,t,i;return t=new ae({props:{name:"wrench"}}),{c(){s=M("div"),n=Y("!"),$(t.$$.fragment),this.h()},l(e){s=S(e,"DIV",{class:!0});var r=C(s);n=J(r,"!"),ee(t.$$.fragment,r),r.forEach(d),this.h()},h(){y(s,"class","graph-error")},m(e,r){b(e,s,r),D(s,n),te(t,s,null),i=!0},i(e){i||(x(t.$$.fragment,e),i=!0)},o(e){q(t.$$.fragment,e),i=!1},d(e){e&&d(s),se(t)}}}function ve(a){let s,n,t,i,e=a[1]&&U();return{c(){s=M("div"),n=W(),e&&e.c(),t=F()},l(r){s=S(r,"DIV",{}),C(s).forEach(d),n=K(r),e&&e.l(r),t=F()},m(r,o){b(r,s,o),a[4](s),b(r,n,o),e&&e.m(r,o),b(r,t,o),i=!0},p(r,[o]){r[1]?e?o&2&&x(e,1):(e=U(),e.c(),x(e,1),e.m(t.parentNode,t)):e&&(Q(),q(e,1,1,()=>{e=null}),Z())},i(r){i||(x(e),i=!0)},o(r){q(e),i=!1},d(r){r&&(d(s),d(n),d(t)),a[4](null),e&&e.d(r)}}}function be(a,s,n){let{car:t}=s,{showForce:i=!0}=s,e,r;function o(u){O[u?"unshift":"push"](()=>{e=u,n(0,e),n(2,t),n(3,i)})}return a.$$set=u=>{"car"in u&&n(2,t=u.car),"showForce"in u&&n(3,i=u.showForce)},a.$$.update=()=>{if(a.$$.dirty&13&&e){n(0,e.innerHTML="",e);try{_e(t,e,{isGearForce:i}),n(1,r=!1)}catch{n(1,r=!0)}}},[e,r,t,i,o]}class Ee extends A{constructor(s){super(),j(this,s,be,ve,E,{car:2,showForce:3})}}function xe(a,s,n={}){let t=n.colors?n.colors:["blue","red","orange","green"],i=[];for(let h=0;h<a.length;h++){a[h];let f={label:"torque",scale:"nm",value:(m,l)=>l==null?"-":l.toFixed(0),stroke:t[h],dash:[10,5],spanGaps:!0,points:{show:!1}},g={label:"power",scale:"hp",value:(m,l)=>l==null?"-":l.toFixed(0),stroke:t[h],spanGaps:!0,points:{show:!1}};i.push(f),i.push(g)}function e(h,f=100){let g=0,m=h.map(w=>w.engine.torqueCurve[w.engine.torqueCurve.length-1][0]),l=Math.max(...m),p=[];for(var c=g;c<=l;c+=f)p.push(c);return p}function r(h,f){let g=h.engine;g.torqueXMultiplier;let m=R(g.torqueCurve,f,g.power),l=ge(m,f);return{torque:m,power:l}}function o(h){let f=e(h),g=[f];for(var m=0;m<h.length;m++){let l=h[m];l.engine.torqueXMultiplier;let c=[],w=[];for(let v=0;v<f.length;v++){let k=f[v],{torque:G,power:ie}=r(l,k);c.push(G),w.push(ie)}g.push(c),g.push(w)}return g}let u=o(a);const _={title:"Power",width:800,height:300,cursor:{drag:{setScale:!1}},series:[{},...i],scales:{x:{title:"rpm",time:!1},hp:{}},axes:[{},{space:60,scale:"nm",values:(h,f,g)=>f.map(m=>+m.toFixed(0)),side:1,grid:{show:!1}},{space:60,scale:"hp",values:(h,f,g)=>f.map(m=>+m.toFixed(0)),side:1,grid:{show:!1}}]};new re(_,u,s)}function H(a){let s,n,t,i;return t=new ae({props:{name:"wrench"}}),{c(){s=M("div"),n=Y("!"),$(t.$$.fragment),this.h()},l(e){s=S(e,"DIV",{class:!0});var r=C(s);n=J(r,"!"),ee(t.$$.fragment,r),r.forEach(d),this.h()},h(){y(s,"class","graph-error")},m(e,r){b(e,s,r),D(s,n),te(t,s,null),i=!0},i(e){i||(x(t.$$.fragment,e),i=!0)},o(e){q(t.$$.fragment,e),i=!1},d(e){e&&d(s),se(t)}}}function ye(a){let s,n,t,i,e=a[1]&&H();return{c(){s=M("div"),n=W(),e&&e.c(),t=F()},l(r){s=S(r,"DIV",{}),C(s).forEach(d),n=K(r),e&&e.l(r),t=F()},m(r,o){b(r,s,o),a[4](s),b(r,n,o),e&&e.m(r,o),b(r,t,o),i=!0},p(r,[o]){r[1]?e?o&2&&x(e,1):(e=H(),e.c(),x(e,1),e.m(t.parentNode,t)):e&&(Q(),q(e,1,1,()=>{e=null}),Z())},i(r){i||(x(e),i=!0)},o(r){q(e),i=!1},d(r){r&&(d(s),d(n),d(t)),a[4](null),e&&e.d(r)}}}function Ce(a,s,n){let{cars:t}=s,{opts:i={}}=s,e,r;function o(u){O[u?"unshift":"push"](()=>{e=u,n(0,e),n(2,t),n(3,i)})}return a.$$set=u=>{"cars"in u&&n(2,t=u.cars),"opts"in u&&n(3,i=u.opts)},a.$$.update=()=>{if(a.$$.dirty&13&&e){n(0,e.innerHTML="",e);try{xe(t,e,i),n(1,r=!1)}catch{n(1,r=!0)}}},[e,r,t,i,o]}class De extends A{constructor(s){super(),j(this,s,Ce,ye,E,{cars:2,opts:3})}}export{ae as I,Re as S,Ee as U,De as a,Pe as b};

import{s as he,e as h,a as P,t as A,c as b,b as w,f as _,g as $,d as B,p as K,i as G,h as p,w as N,x as C,y as O,j as de,r as be,z as ge,A as ke,l as ve}from"../chunks/scheduler.C19aQTI2.js";import{S as Te,i as Se,c as ne,b as ae,m as se,a as le,t as oe,d as re}from"../chunks/index.B0knyX5n.js";import{U as pe}from"../chunks/UPlotRealtime.D_Ew3F7X.js";import{c as Ie}from"../chunks/svgTrafficGraph.DbPXYMwD.js";import{C as me,a as fe,u as ye}from"../chunks/index.BPu2XYXM.js";import{S as Pe}from"../chunks/simulation2.CRWH4vD6.js";function $e(){let e={reactionTime:1,speed:27,followingDistance:40,brakeApplyTime:.5};const s=Pe(),l=new me(fe("renault_zoe")),n=new me(fe("renault_zoe")),a=[l,n];m();function r(u){e=Object.assign(e,u),m()}function m(){s.isPlaying===!1&&(l.state.position=50,n.state.position=50-e.followingDistance,l.state.speed=27,n.state.speed=27)}function o(u,g){const S=ce(u/1e3,e.reactionTime,e.reactionTime+e.brakeApplyTime,0,1);l.state.brakeInput=S;const f=ce(u/1e3,e.reactionTime+e.reactionTime,e.reactionTime+e.reactionTime+e.brakeApplyTime,0,1);n.state.brakeInput=f,a.forEach((d,k)=>{ye(d,g),d.state.brakeInput<=0&&(d.state.speed=e.speed);const V=d.state.speed;d.state.position+=V*(g/1e3),n.state.speed===0&&s.stop()})}return s.subscribeTick(o),{setOptions:r,simulation:s,cars:a}}function ce(e,s,l,n,a){const r=(e-s)/(l-s);let m=n+r*(a-n);return m=Math.min(Math.max(m,n),a),m}function _e(e){let s,l=e[4]?"Stop":"Start",n,a,r,m;return{c(){s=h("button"),n=A(l),a=A(" Simulation")},l(o){s=b(o,"BUTTON",{});var u=w(s);n=B(u,l),a=B(u," Simulation"),u.forEach(_)},m(o,u){G(o,s,u),p(s,n),p(s,a),r||(m=C(s,"click",e[9]),r=!0)},p(o,u){u&16&&l!==(l=o[4]?"Stop":"Start")&&de(n,l)},d(o){o&&_(s),r=!1,m()}}}function we(e){let s,l,n,a,r,m,o,u,g,S,f,d,k,V,z=e[6]/(e[5]/3.6)+"",H,Q,D,W,v,I,R,Z,y,Y,T,E,M,U,x,L,X,ee,ue,c=e[1]&&_e(e);return E=new pe({props:{title:"Brake",key:"brakeInput",time:e[3],observed:e[0]}}),U=new pe({props:{title:"Speed",key:"speed",transformFn:Ce,time:e[3],observed:e[0]}}),L=new pe({props:{title:"Position",key:"position",time:e[3],observed:e[0]}}),{c(){s=h("div"),l=P(),c&&c.c(),n=P(),a=h("ul"),r=h("li"),m=A("Speed in km/h: "),o=h("input"),u=P(),g=h("li"),S=A("Distance in m: "),f=h("input"),d=P(),k=h("li"),V=A("Distance in s : "),H=A(z),Q=P(),D=h("li"),W=A("Reaction time in s: "),v=h("input"),I=P(),R=h("li"),Z=A("Brake application time in s: "),y=h("input"),Y=P(),T=h("div"),ne(E.$$.fragment),M=P(),ne(U.$$.fragment),x=P(),ne(L.$$.fragment),this.h()},l(t){s=b(t,"DIV",{class:!0}),w(s).forEach(_),l=$(t),c&&c.l(t),n=$(t),a=b(t,"UL",{});var i=w(a);r=b(i,"LI",{});var j=w(r);m=B(j,"Speed in km/h: "),o=b(j,"INPUT",{type:!0}),j.forEach(_),u=$(i),g=b(i,"LI",{});var F=w(g);S=B(F,"Distance in m: "),f=b(F,"INPUT",{type:!0}),F.forEach(_),d=$(i),k=b(i,"LI",{});var q=w(k);V=B(q,"Distance in s : "),H=B(q,z),q.forEach(_),Q=$(i),D=b(i,"LI",{});var te=w(D);W=B(te,"Reaction time in s: "),v=b(te,"INPUT",{type:!0}),te.forEach(_),I=$(i),R=b(i,"LI",{});var ie=w(R);Z=B(ie,"Brake application time in s: "),y=b(ie,"INPUT",{type:!0}),ie.forEach(_),i.forEach(_),Y=$(t),T=b(t,"DIV",{class:!0});var J=w(T);ae(E.$$.fragment,J),M=$(J),ae(U.$$.fragment,J),x=$(J),ae(L.$$.fragment,J),J.forEach(_),this.h()},h(){K(s,"class","graph svelte-13yckni"),K(o,"type","number"),K(f,"type","number"),K(v,"type","number"),K(y,"type","number"),K(T,"class","grid")},m(t,i){G(t,s,i),e[11](s),G(t,l,i),c&&c.m(t,i),G(t,n,i),G(t,a,i),p(a,r),p(r,m),p(r,o),N(o,e[5]),p(a,u),p(a,g),p(g,S),p(g,f),N(f,e[6]),p(a,d),p(a,k),p(k,V),p(k,H),p(a,Q),p(a,D),p(D,W),p(D,v),N(v,e[7]),p(a,I),p(a,R),p(R,Z),p(R,y),N(y,e[8]),G(t,Y,i),G(t,T,i),se(E,T,null),p(T,M),se(U,T,null),p(T,x),se(L,T,null),X=!0,ee||(ue=[C(o,"input",e[12]),C(o,"change",e[10]),C(f,"input",e[13]),C(f,"change",e[10]),C(v,"input",e[14]),C(v,"change",e[10]),C(y,"input",e[15]),C(y,"change",e[10])],ee=!0)},p(t,[i]){t[1]?c?c.p(t,i):(c=_e(t),c.c(),c.m(n.parentNode,n)):c&&(c.d(1),c=null),i&32&&O(o.value)!==t[5]&&N(o,t[5]),i&64&&O(f.value)!==t[6]&&N(f,t[6]),(!X||i&96)&&z!==(z=t[6]/(t[5]/3.6)+"")&&de(H,z),i&128&&O(v.value)!==t[7]&&N(v,t[7]),i&256&&O(y.value)!==t[8]&&N(y,t[8]);const j={};i&8&&(j.time=t[3]),i&1&&(j.observed=t[0]),E.$set(j);const F={};i&8&&(F.time=t[3]),i&1&&(F.observed=t[0]),U.$set(F);const q={};i&8&&(q.time=t[3]),i&1&&(q.observed=t[0]),L.$set(q)},i(t){X||(le(E.$$.fragment,t),le(U.$$.fragment,t),le(L.$$.fragment,t),X=!0)},o(t){oe(E.$$.fragment,t),oe(U.$$.fragment,t),oe(L.$$.fragment,t),X=!1},d(t){t&&(_(s),_(l),_(n),_(a),_(Y),_(T)),e[11](null),c&&c.d(t),re(E),re(U),re(L),ee=!1,be(ue)}}}function Ce(e){return e*3.6}function De(e,s,l){let n,a,r,m,o,u,g=!1,S=90,f=40,d=1,k=.5;ge(()=>{n=$e(),l(0,a=n.cars),l(1,r=n.simulation),m=Ie(o,a),n.simulation.subscribeTick((I,R)=>{l(3,u=I)})}),ke(()=>{r&&r.stop(),m&&m.destroy()});function V(){r.isPlaying?r.stop():r.start(),l(4,g=r.isPlaying)}function z(I){n&&n.setOptions({speed:S/3.6,followingDistance:f,reactionTime:d,brakeApplyTime:k})}function H(I){ve[I?"unshift":"push"](()=>{o=I,l(2,o)})}function Q(){S=O(this.value),l(5,S)}function D(){f=O(this.value),l(6,f)}function W(){d=O(this.value),l(7,d)}function v(){k=O(this.value),l(8,k)}return[a,r,o,u,g,S,f,d,k,V,z,H,Q,D,W,v]}class Oe extends Te{constructor(s){super(),Se(this,s,De,we,he,{})}}export{Oe as component};

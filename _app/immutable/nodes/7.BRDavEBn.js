import{s as A,e as E,c as G,b as K,f as d,p as R,i as b,n as te,l as le,a as C,B as N,g as w,x as B,z as ie,A as ne,G as H,r as re,t as I,d as S,h as O,j as P,H as pe}from"../chunks/scheduler.C19aQTI2.js";import{S as X,i as J,c as D,b as F,m as y,a as $,g as L,t as T,e as V,d as U}from"../chunks/index.B0knyX5n.js";import{e as be}from"../chunks/each.OpygIZJG.js";import{c as fe}from"../chunks/svgTrafficGraph.DbPXYMwD.js";import{u as ve}from"../chunks/uPlot.min.D9LKXES3.js";import{U as M}from"../chunks/UPlotRealtime.D_Ew3F7X.js";import{D as se}from"../chunks/TrafficSim.svelte_svelte_type_style_lang.C1bFZHyO.js";function j(f){let i,a="Stop Simulation",r,_,u="stop first car",c,h,m,l,e,o,s,t=f[4]&&q(f),p=f[5]&&z(f),k=f[3]&&!1;return{c(){i=E("button"),i.textContent=a,r=C(),_=E("button"),_.textContent=u,c=C(),t&&t.c(),h=C(),p&&p.c(),m=C(),k&&k.c(),l=N()},l(n){i=G(n,"BUTTON",{"data-svelte-h":!0}),H(i)!=="svelte-1tthgpy"&&(i.textContent=a),r=w(n),_=G(n,"BUTTON",{"data-svelte-h":!0}),H(_)!=="svelte-68ycc2"&&(_.textContent=u),c=w(n),t&&t.l(n),h=w(n),p&&p.l(n),m=w(n),k&&k.l(n),l=N()},m(n,g){b(n,i,g),b(n,r,g),b(n,_,g),b(n,c,g),t&&t.m(n,g),b(n,h,g),p&&p.m(n,g),b(n,m,g),k&&k.m(n,g),b(n,l,g),e=!0,o||(s=[B(i,"click",f[9]),B(_,"click",f[8])],o=!0)},p(n,g){n[4]?t?(t.p(n,g),g&16&&$(t,1)):(t=q(n),t.c(),$(t,1),t.m(h.parentNode,h)):t&&(L(),T(t,1,1,()=>{t=null}),V()),n[5]?p?p.p(n,g):(p=z(n),p.c(),p.m(m.parentNode,m)):p&&(p.d(1),p=null),n[3],k&&(L(),T(k,1,1,()=>{k=null}),V())},i(n){e||($(t),$(k),e=!0)},o(n){T(t),T(k),e=!1},d(n){n&&(d(i),d(r),d(_),d(c),d(h),d(m),d(l)),t&&t.d(n),p&&p.d(n),k&&k.d(n),o=!1,re(s)}}}function q(f){let i,a=f[4].id+"",r,_,u,c,h,m,l,e,o;return c=new M({props:{title:"Speed",key:"speed",transformFn:ae,time:f[1],observed:[f[4]]}}),m=new M({props:{title:"Brake",key:"brakeInput",time:f[1],observed:[f[4]]}}),e=new M({props:{title:"Throttle",key:"throttleInput",time:f[1],observed:[f[4]]}}),{c(){i=I("Selected Car : "),r=I(a),_=C(),u=E("div"),D(c.$$.fragment),h=C(),D(m.$$.fragment),l=C(),D(e.$$.fragment),this.h()},l(s){i=S(s,"Selected Car : "),r=S(s,a),_=w(s),u=G(s,"DIV",{class:!0});var t=K(u);F(c.$$.fragment,t),h=w(t),F(m.$$.fragment,t),l=w(t),F(e.$$.fragment,t),t.forEach(d),this.h()},h(){R(u,"class","grid")},m(s,t){b(s,i,t),b(s,r,t),b(s,_,t),b(s,u,t),y(c,u,null),O(u,h),y(m,u,null),O(u,l),y(e,u,null),o=!0},p(s,t){(!o||t&16)&&a!==(a=s[4].id+"")&&P(r,a);const p={};t&2&&(p.time=s[1]),t&16&&(p.observed=[s[4]]),c.$set(p);const k={};t&2&&(k.time=s[1]),t&16&&(k.observed=[s[4]]),m.$set(k);const n={};t&2&&(n.time=s[1]),t&16&&(n.observed=[s[4]]),e.$set(n)},i(s){o||($(c.$$.fragment,s),$(m.$$.fragment,s),$(e.$$.fragment,s),o=!0)},o(s){T(c.$$.fragment,s),T(m.$$.fragment,s),T(e.$$.fragment,s),o=!1},d(s){s&&(d(i),d(r),d(_),d(u)),U(c),U(m),U(e)}}}function z(f){let i,a=f[3][f[5]].currentTask+"",r,_,u=f[3][f[5]].TTI.toFixed(1)+"",c,h,m=f[3][f[5]].TTC.toFixed(1)+"",l;return{c(){i=I(`Driver
task : `),r=I(a),_=I(`
tti : `),c=I(u),h=I(`
ttc : `),l=I(m)},l(e){i=S(e,`Driver
task : `),r=S(e,a),_=S(e,`
tti : `),c=S(e,u),h=S(e,`
ttc : `),l=S(e,m)},m(e,o){b(e,i,o),b(e,r,o),b(e,_,o),b(e,c,o),b(e,h,o),b(e,l,o)},p(e,o){o&40&&a!==(a=e[3][e[5]].currentTask+"")&&P(r,a),o&40&&u!==(u=e[3][e[5]].TTI.toFixed(1)+"")&&P(c,u),o&40&&m!==(m=e[3][e[5]].TTC.toFixed(1)+"")&&P(l,m)},d(e){e&&(d(i),d(r),d(_),d(c),d(h),d(l))}}}function oe(f){let i,a,r,_,u,c,h,m;r=new se({props:{debugPerf:f[6]}});let l=f[0]&&j(f);return{c(){i=E("div"),a=C(),D(r.$$.fragment),_=C(),l&&l.c(),u=N(),this.h()},l(e){i=G(e,"DIV",{class:!0}),K(i).forEach(d),a=w(e),F(r.$$.fragment,e),_=w(e),l&&l.l(e),u=N(),this.h()},h(){R(i,"class","graph svelte-13yckni")},m(e,o){b(e,i,o),f[11](i),b(e,a,o),y(r,e,o),b(e,_,o),l&&l.m(e,o),b(e,u,o),c=!0,h||(m=B(i,"carClick",f[7]),h=!0)},p(e,[o]){const s={};o&64&&(s.debugPerf=e[6]),r.$set(s),e[0]?l?(l.p(e,o),o&1&&$(l,1)):(l=j(e),l.c(),$(l,1),l.m(u.parentNode,u)):l&&(L(),T(l,1,1,()=>{l=null}),V())},i(e){c||($(r.$$.fragment,e),$(l),c=!0)},o(e){T(r.$$.fragment,e),T(l),c=!1},d(e){e&&(d(i),d(a),d(_),d(u)),f[11](null),U(r,e),l&&l.d(e),h=!1,m()}}}function ae(f){return f*3.6}function ue(f,i,a){let{traffic_sim:r}=i,{showUI:_=!1}=i,u=r,c,h,m,l,e,o,s,t,p;ie(()=>{m=u.cars,a(3,l=u.drivers),e=u.simulation,console.log("traffic sim cars",m),t=fe(c,m),c.addEventListener("carClick",n),u.simulation.subscribeTick((v,Y)=>{a(1,h=v)}),a(6,p=t.debug.perf),window.addEventListener("keydown",W)}),ne(()=>{e&&e.stop(),t&&t.destroy()});function k(v){return l}function n(v){console.log("click",v);let Y=v.detail;a(4,o=m.find(ee=>ee.id===Y.id));let x=u.findCarDriver(o,l);a(5,s=x)}function g(){l[0].stopCar()}function Q(){e.isPlaying?e.stop():e.start()}function W(v){v.key==="s"&&s&&l[s].stopCar()}function Z(v){le[v?"unshift":"push"](()=>{c=v,a(2,c)})}return f.$$set=v=>{"traffic_sim"in v&&a(10,r=v.traffic_sim),"showUI"in v&&a(0,_=v.showUI)},f.$$.update=()=>{f.$$.dirty&2&&a(3,l=k())},[_,h,c,l,o,s,p,n,g,Q,r,Z]}class ce extends X{constructor(i){super(),J(this,i,ue,oe,A,{traffic_sim:10,showUI:0})}}function me(f){let i,a;return i=new ce({props:{showUI:!0}}),{c(){D(i.$$.fragment)},l(r){F(i.$$.fragment,r)},m(r,_){y(i,r,_),a=!0},p:te,i(r){a||($(i.$$.fragment,r),a=!0)},o(r){T(i.$$.fragment,r),a=!1},d(r){U(i,r)}}}class Ce extends X{constructor(i){super(),J(this,i,null,me,A,{})}}export{Ce as component};
